# 探测周期性 - 实验报告

## 1. 实验目的

本实验旨在通过傅里叶变换分析太阳黑子数据的周期性，具体目标包括：
- 学习使用傅里叶变换分析时间序列数据中的周期性特征
- 掌握功率谱的计算和解释方法
- 理解太阳黑子活动的周期性规律及其物理意义

## 2. 方法简述

请简要描述您实现的算法和方法，特别是：
- 数据获取和预处理的方法
- 傅里叶变换的实现方式
- 功率谱的计算方法
- 峰值检测和周期确定的策略
从网上下载数据，并读取年份，黑字数信息。画出黑字数，时间图像。
用fft快速傅里叶变换由黑子数与年份取点数得到傅里叶变换后的功率谱和频率数组
将时域信息转化为频域的展开，对一些次极大的噪声不做考虑
将频率数组取倒数，得到功率谱对应的周期，在功率谱中寻找最值（主极大），对应周期便可得到黑子数变化的主周期
_在此处填写您的方法描述（约200-300字）_

## 3. 实验结果

### 3.1 太阳黑子数据时间序列

请在此处粘贴您生成的太阳黑子数量随时间变化的图像，并简要说明您从图中观察到的周期性特征。

_在此处插入时间序列图像_
![屏幕截图 2025-05-21 113556](https://github.com/user-attachments/assets/135bb71d-ed91-42cb-9972-f0e2fd215abd)

图像说明：
_在此处添加对图像的解释（约100字）_
有显著周期性变化，肉眼观察周期在10年左右，此外可以看出峰值在以周期约为100年的尺度上有一个浮动，将会在频率谱上以次峰表现出来，或对应格莱斯堡周期（80-90y）
### 3.2 功率谱分析

请在此处粘贴您生成的功率谱图像，并标明主要峰值对应的周期。
![屏幕截图 2025-05-21 113549](https://github.com/user-attachments/assets/8d9ca5b6-bc52-461e-b621-0a5a8c3106c0)

_在此处插入功率谱图像_

图像说明：
_在此处添加对图像的解释（约100字）_
可看出有一个主极大的峰在138.17月，约11.5年，可见由频谱得出的主周期约是11.5年，与肉眼观察时域谱相差不大，还可看出有一个次峰在1200月，对应100年周期，这也可以从时域图上看出一个周期性变化（100年峰值），象征太阳活动的大周期。
### 3.3 周期确定

请列出您通过不同方法确定的太阳黑子周期：

| 确定方法 | 周期（月） | 周期（年） |
|---------|----------|----------|
| 目视估计 |    120      |     10     |
| 傅里叶分析 |    138.17     |     11.5     |

两种方法的相对误差：_0.13____

## 4. 分析与讨论

### 4.1 太阳黑子周期的物理意义

请讨论太阳黑子周期的物理成因及其对地球的影响：
- 太阳黑子形成的物理机制是什么？
  黑子本质是太阳表面局部强磁场，温度较低，可能是磁流管中大致与日面垂直的磁力线部分抑制对流。
- 太阳黑子周期与太阳磁场活动有什么关系？
  黑子和黑子群的演化实际就是太阳大气局部磁场的演化过程
- 太阳黑子活动对地球气候、通信系统等有何影响？

_在此处填写您的分析（约200字）_
黑子本质是太阳表面局部强磁场，温度较低，低温原因可能是磁流管中大致与日面垂直的磁力线部分抑制对流。
黑子和黑子群的演化实际就是太阳大气局部磁场的演化过程，黑子数量以平均约11年为周期波动，称为太阳活动周期。此周期实际是太阳全局磁场极性反转的结果，完整磁周期为22年。磁场在11年周期内逐渐增强并达到峰值（对应黑子极大期），随后因磁浮力不稳定导致磁场线“浮现”到表面，形成黑子对。最终，磁场在极区发生极性反转，完成22年的完整磁周期。
黑子区域的复杂磁场结构储存巨大磁能，重联时释放能量，引发剧烈爆发活动如日冕物质抛射，其频率与黑子周期同步。磁场活动极大期时，日冕结构更复杂，太阳风高速流增多，影响地球空间环境。
太阳黑子活动以约11年为周期波动，在活动极大期（如2024-2025年），太阳总辐射量略有增强，可能通过影响大气环流导致局部气候异常。例如，历史上的“蒙德极小期”（1645-1715年）因太阳黑子锐减，全球气温下降，引发“小冰期”，黑子活动剧烈时空间天气较复杂恶劣，会影响卫星（高能带电粒子可穿透卫星防护层，损坏电子元件），导航，通讯，可能会对电力系统有影响（如太阳风暴引发的地磁感应电流（GIC）可侵入电力网络，导致变压器过热甚至烧毁。1989年加拿大魁北克大停电即因太阳风暴导致电网崩溃，停电持续9小时）等多方面。

### 4.2 傅里叶变换方法的优缺点

讨论使用傅里叶变换分析周期性信号的优缺点：
- 傅里叶变换在分析周期性信号时的优势是什么？
- 在本实验中，傅里叶变换方法可能存在哪些局限性？
- 有哪些其他方法可以用来分析时间序列的周期性？它们与傅里叶变换相比有何异同？

_在此处填写您的讨论（约200字）_
优势：周期性信号（如正弦波、方波）通常由基频及其整数倍谐波组成。傅里叶变换能将时域信号分解为频域的离散频率分量，直接量化基频和各次谐波的幅度与相位。可以清晰地看出主要的频率成分，形成一个过滤的作用。通过调整采样时间长度（满足频谱分辨率Δf=1/T，T为信号时长），可精确区分相邻频率成分，尤其适用于多周期信号叠加的场景。
局限性： 
高动态范围信号的量化失真：强弱信号共存问题：当信号包含极大动态范围的频率成分时，弱信号可能被强信号的旁瓣掩盖。
非周期信号（如随机噪声、湍流数据）的傅里叶谱呈现连续分布，难以提取有效特征。
傅里叶变换无法定位信号特征发生的时间点。
数据点如果较少可能分析出一些伪周期
### 4.3 思考题

1. 如果太阳黑子数据中存在长期趋势（如逐年增加或减少的趋势），这会如何影响傅里叶分析的结果？应该如何处理这种趋势？

_在此处填写您的回答（约100字）_
趋势可能被误认为超长周期信号。傅里叶变换会将这种趋势误判为低频周期信号，从而干扰真正的周期成分检测。长期趋势在时域表现为缓慢变化的低频分量，傅里叶变换会将其误判为接近零频率（极低频）的正弦波。由于实际信号长度有限（截断效应），这种趋势会导致频谱能量扩散到邻近频率（频谱泄漏），掩盖真实周期成分。
2. 太阳黑子数据从1749年开始记录，到现在已有270多年的数据。如果我们只使用最近100年的数据进行分析，结果会有什么不同？为什么？

_在此处填写您的回答（约100字）_
1.趋势可能被误认为超长周期信号。傅里叶变换会将这种趋势误判为低频周期信号，从而干扰真正的周期成分检测。长期趋势在时域表现为缓慢变化的低频分量，傅里叶变换会将其误判为接近零频率（极低频）的正弦波。由于实际信号长度有限（截断效应），这种趋势会导致频谱能量扩散到邻近频率（频谱泄漏），掩盖真实周期成分。
2.数据点减少可能导致噪声更显著，信噪比降低，比如黑子的非周期性的变动，此外，世纪周期难以在频谱中不明显或偏移，若太阳黑子周期存在缓慢调制（如11年周期在19世纪为9年，20世纪为11年），100年数据可能将其视为固定周期，而270年数据可揭示其动态变化。
使用最近100年数据与270年数据分析太阳黑子周期的主要差异如下：
长周期检测失效：无法可靠识别格莱斯堡周期（~80-90年）。
短周期估计偏差：11年周期的幅度和显著性受现代活动高峰影响可能偏高。
物理机制解释局限：忽略蒙德极小期等极端事件，难以揭示周期调制机制。
建议：
若目标为研究施瓦贝周期（11年），100年数据足够且噪声更低。
若需分析世纪级规律或太阳活动长期演化，必须使用完整历史数据。
结合多尺度方法（如小波分析）可部分弥补数据长度限制
## 5. 结论

总结本实验的主要发现和收获，包括对太阳黑子周期性的认识以及傅里叶变换在周期性分析中的应用。

_在此处填写您的结论（约150字）_
认识到了傅里叶变换频谱分析的实际意义，学会了用傅里叶分析周期性数据的性质，学习了如何编写傅里叶变换程序，如何使用numpy自带的fft包
了解了傅里叶变换的优缺点：
周期性信号（如正弦波、方波）通常由基频及其整数倍谐波组成。傅里叶变换能将时域信号分解为频域的离散频率分量，直接量化基频和各次谐波的幅度与相位。可以清晰地看出主要的频率成分，形成一个过滤的作用。通过调整采样时间长度（满足频谱分辨率Δf=1/T，T为信号时长），可精确区分相邻频率成分，尤其适用于多周期信号叠加的场景。
高动态范围信号的量化失真：强弱信号共存问题：当信号包含极大动态范围的频率成分时，弱信号可能被强信号的旁瓣掩盖。
非周期信号（如随机噪声、湍流数据）的傅里叶谱呈现连续分布，难以提取有效特征。
对傅里叶分析的使用方法即原理有了深入了解。
## 核心代码片段

请粘贴您实现的关键函数代码（如傅里叶变换和功率谱计算），并简要说明代码的核心思路。

```python
# 在此处粘贴核心代码片段（不超过30行）
def load_sunspot_data(url):
    data = np.loadtxt(url, usecols=(2,3), comments='#')
    years = data[:,0]
    sunspots = data[:,1]
    return years, sunspots
def plot_sunspot_data(years, sunspots):
    plt.figure(figsize=(12, 6))
    plt.plot(years, sunspots)
    plt.xlabel('Year')
    plt.ylabel('Sunspot Number')
    plt.title('Sunspot Number Variation (1749-Present)')
    plt.grid(True)
    plt.show()
def compute_power_spectrum(sunspots):
    n = sunspots.size
    fft_result = np.fft.fft(sunspots)
    # 计算功率谱 (只取正频率部分)
    power = np.abs(fft_result[:n//2])**2
    frequencies = np.fft.fftfreq(n, d=1)[:n//2] 
    return frequencies, power

def plot_power_spectrum(frequencies, power):
    plt.figure(figsize=(12, 6))
    plt.plot(1/frequencies[1:], power[1:])  # 忽略零频率
    plt.xlabel('Period (months)')
    plt.ylabel('Power')
    plt.title('Power Spectrum of Sunspot Data')
    plt.grid(True)
    plt.show()
def find_main_period(frequencies, power):
    idx = np.argmax(power[1:])+1 #忽略0频率
    main_period = 1/frequencies[idx]
    return main_period
```

代码说明：
_在此处简要解释代码的实现思路（约100字）_
用fft快速傅里叶变换由黑子数与年份取点数得到傅里叶变换后的功率谱和频率数组
将时域信息转化为频域的展开
将频率数组取倒数，得到功率谱对应的周期，在功率谱中寻找最值（主极大），对应周期便可得到黑子数变化的主周期
