# 傅立叶滤波和平滑 - 实验报告

## 1. 实验目的

本实验旨在通过对道琼斯工业平均指数数据进行傅立叶变换和滤波处理，达到以下目标：
- 掌握傅立叶变换在金融时间序列分析中的应用
- 理解不同频率成分对信号的影响
- 学习通过频域滤波提取信号特征的方法
- 分析滤波参数变化对结果的影响

## 2. 方法简述

请简要描述您实现的算法和方法，特别是：
- 数据加载和预处理的方法
- 傅立叶变换和逆变换的实现
- 滤波器的设计原理（保留前10%和前2%系数的实现）
- 可视化方法的选择

_在此处填写您的方法描述（约200-300字）_

数据加载与预处理：

使用pandas读取道琼斯指数 CSV 数据，提取收盘价序列，转换为 numpy 数组。

对数据进行去均值处理（减去均值），消除直流分量对傅立叶变换的影响。

傅立叶变换实现：

采用np.fft.rfft()对实数信号进行快速傅立叶变换，得到频域系数（实部 + 虚部），其中低频成分集中在系数数组前半部分。

通过np.fft.irfft()进行逆变换，将滤波后的频域系数还原为时域信号。

滤波器设计：

低通滤波逻辑：保留前keep_fraction比例的低频系数，置零高频系数。

10% 系数保留：保留前 10% 低频系数，抑制 90% 高频成分（对应短期噪声）。

2% 系数保留：仅保留前 2% 低频系数，进一步过滤中期波动，提取极低频趋势。

可视化方法：

使用matplotlib绘制原始数据、10% 滤波结果、2% 滤波结果的时间序列图，对比不同滤波强度下的信号形态差异。
## 3. 实验结果

### 3.1 原始数据时间序列

请在此处粘贴您生成的道琼斯工业平均指数原始数据时间序列图，并说明您从图中观察到的特征。
![image](https://github.com/user-attachments/assets/21a43d7d-8ef1-403e-9a96-b14b9713b825)

_在此处插入原始数据时间序列图像_

图像说明：
_在此处添加对图像的解释（约100字）_

图像说明：

原始信号呈现明显的长期上升趋势（低频成分），叠加频繁的短期波动（高频成分）。波动幅度随时间变化，可能反映经济周期或市场情绪的影响，整体非严格周期性，存在趋势性漂移。

### 3.2 保留前10%系数的滤波结果

请在此处粘贴您生成的保留前10%傅立叶系数的滤波结果图像，并说明：
1. 滤波后信号与原始信号的差异
2. 被抑制的频率成分对信号的影响

_在此处插入10%滤波结果图像_
![image](https://github.com/user-attachments/assets/a35533b4-369d-4811-a4b4-cd4af6bd87e6)

图像说明：

_在此处添加对图像的解释（约100字）_

差异：滤波后信号保留了原始趋势，但高频噪声显著减少，曲线平滑度提升，局部波动幅度降低。

频率影响：被抑制的高频成分对应市场短期震荡（如日内 / 周内波动），滤波后凸显季度 / 年度级别的中期趋势。

### 3.3 保留前2%系数的滤波结果

请在此处粘贴您生成的保留前2%傅立叶系数的滤波结果图像，并说明：
1. 与10%滤波结果的对比
2. 更严格滤波对信号的影响

_在此处插入2%滤波结果图像_
![image](https://github.com/user-attachments/assets/1a90d2a6-d650-4abf-8e8f-e759375ee772)

图像说明：
_在此处添加对图像的解释（约100字）_

对比：与 10% 滤波结果相比，2% 滤波进一步消除中期波动，仅保留极低频趋势，曲线接近单调上升的直线。

极端影响：严格滤波导致信号过度平滑，可能丢失经济周期中的次级趋势（如行业轮动、政策干预引发的中期波动）

## 4. 分析与讨论

### 4.1 不同滤波参数的影响

请讨论：
- 保留10%系数与保留2%系数结果的差异
- 不同滤波强度对信号平滑程度的影响
- 过度滤波可能导致的问题

_在此处填写您的分析（约200字）_

差异本质：保留系数比例决定了保留的频率成分范围。10% 系数保留了低频 + 部分中频成分，反映季度级趋势；2% 系数仅保留极低频，反映年度级长期趋势。

平滑程度：参数越小，平滑效果越强。10% 滤波平衡了噪声抑制与特征保留，2% 滤波则适用于提取绝对趋势，但可能过度简化信号。

过度滤波风险：可能导致信号失真，丢失关键转折点（如经济危机引发的短期暴跌），影响对市场结构的准确分析。

### 4.2 金融时间序列的频率特征

讨论道琼斯指数中不同频率成分可能代表的经济现象：
- 低频成分（长期趋势）反映了什么经济因素？
- 高频成分（短期波动）通常由什么因素引起？

_在此处填写您的讨论（约200字）_

低频成分：反映宏观经济基本面（如 GDP 增长、利率政策、人口结构变化），趋势具有稳定性，持续时间通常为数年至数十年。

高频成分：由市场情绪、突发事件（如财报发布、地缘政治新闻）、技术交易等短期因素引起，波动周期通常在数天至数月内，包含大量噪声但也可能隐含短期交易机会。

### 4.3 思考题

1. 如果我们对道琼斯指数数据进行对数变换后再进行傅立叶分析，结果会有什么不同？

_在此处填写您的回答（约100字）_

对数变换将价格的乘法增长转为加法增长（即收益率分析），傅立叶变换后低频成分对应长期收益率趋势，高频成分对应波动率变化，更适合分析相对增长而非绝对价格，结果可能更符合经济学中 “收益率平稳性” 假设。

2. 傅立叶变换假设信号是周期性的，但金融数据通常不是严格周期性的。这会导致什么问题？

_在此处填写您的回答（约100字）_

傅立叶变换假设信号周期性延拓，金融数据的非周期性会导致频谱泄漏—— 能量从真实频率扩散到相邻频率，使滤波结果出现伪影（如趋势边缘振荡）。可通过加窗函数（如汉宁窗）减轻泄漏，但无法完全消除。

## 5. 结论

总结本实验的主要发现和收获，包括：
- 傅立叶滤波在金融数据分析中的应用价值
- 不同滤波参数的选择经验
- 实验过程中遇到的挑战和解决方法

_在此处填写您的结论（约150字）_

本实验通过傅立叶滤波成功分离了道琼斯指数的高低频成分，验证了频域分析在金融数据平滑中的有效性。关键发现包括：

保留 10% 系数可有效抑制短期噪声，保留经济周期的中期特征；

保留 2% 系数适用于提取长期趋势，但需警惕过度平滑导致的信息丢失；

金融数据的低频趋势与宏观经济强相关，高频波动受市场微观结构影响显著。

实验挑战主要在于确定合理的滤波阈值（需结合业务场景调整）和处理非周期性引入的频谱泄漏，未来可尝试结合小波变换等时频分析方法提升适应性。

## 核心代码片段

请粘贴您实现的关键函数代码（如滤波函数实现），并简要说明代码的核心思路。

```python
def fourier_filter(data, keep_fraction=0.1):
    """
    执行傅立叶变换并滤波
    
    参数:
        data (numpy.ndarray): 输入数据数组
        keep_fraction (float): 保留的傅立叶系数比例
    
    返回:
        tuple: (滤波后的数据数组, 原始傅立叶系数数组)
    """
    # 计算实数信号的傅立叶变换
    fft_coeff = np.fft.rfft(data)
    
    # 计算保留的系数数量
    cutoff = int(len(fft_coeff) * keep_fraction)
    
    # 创建滤波后的系数数组
    filtered_coeff = fft_coeff.copy()
    filtered_coeff[cutoff:] = 0
    
    # 计算逆变换
    filtered_data = np.fft.irfft(filtered_coeff, n=len(data))
    
    return filtered_data, fft_coeff
# 在此处粘贴核心代码片段（不超过30行）
```

代码说明：

_在此处简要解释代码的实现思路（约100字）_

去均值：消除直流分量对频域分析的干扰，确保变换后低频系数反映真实趋势。

频域滤波：通过保留前keep_fraction比例的系数实现低通滤波，高频系数置零以抑制噪声。

均值恢复：逆变换后还原原始数据的均值，保证滤波结果与原始信号量纲一致。
