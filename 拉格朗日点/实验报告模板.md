# 拉格朗日点 - 实验报告

## 1. 实验目的简述

本实验旨在通过数值方法求解地球-月球系统中L1拉格朗日点的位置，具体目标包括：
- 理解拉格朗日点的物理意义及其在天体力学中的重要性
- 推导L1点位置满足的方程
- 实现并比较不同的数值求根方法（牛顿法、弦截法）
- 分析数值方法的收敛性和精度

## 2. 方法简述

请简要描述您实现的算法和方法，特别是：
- L1点位置方程的推导过程和物理意义
- 牛顿法和弦截法的实现策略
- 初值或初始区间的选择依据

地球与月球的牛顿万有引力之差提供向心力，根据牛顿第二定律列出牛顿运动学方程，表示出地月之间的势能平衡点，使卫星能够平稳停靠在L1.牛顿法计算当前函数值与导数值，若函数值绝对值小于tol，判定收敛，返回结果。若导数值接近于0，终止迭代以免数值不稳定。再更新近似解，若相对变化量小于容差，则收敛。弦截法用两个连续点计算差商，更新近似解，若近似解处函数值的绝对值小于tol，判定收敛。检查相对变化量，若小于容差，收敛。最后更新迭代点，达到最大迭代次数或收敛后终止。初始值通过目测函数曲线的走势确定，在逼近零点的一小段光滑曲线上取值。

## 3. 实验结果

### 3.1 L1点位置方程可视化

请在此处粘贴您生成的L1点位置方程图像，并简要说明图中的零点位置及其物理意义。

![计算物理1](https://github.com/user-attachments/assets/22752cb5-fd7a-457d-af8c-d67f7e2cefb1)


图像说明：
该函数的零点正好体现出牛顿第二定律列出的方程的零点，就是万有引力刚好提供向心力的点，惯性力与引力和相互平衡，在非惯性参考系下卫星处于相对静止，达到平衡状态，就是我们需要的势能平衡点。
### 3.2 数值求解结果

请列出使用不同方法求解L1点位置的结果：

| 求解方法 | L1点位置 (m) | 相对于地月距离的比例 | 迭代次数 | 是否收敛 |
|---------|------------|-------------------|---------|--------|
| 牛顿法   |  3.26045164e+08 m |  0.848192    | 5 |     是   |
| 弦截法   | 3.26044996e+08 m | 0.848192   |5 |    是    |
| fsolve  | 3.26045072e+08 m   |  0.848192   | -       | -      |

### 3.3 不同方法的结果比较

请计算不同方法之间的结果差异：

| 比较项 | 绝对差异 (m) | 相对差异 (%) |
|-------|------------|-------------|
| 牛顿法 vs 弦截法 | 1.67623739e+02 m | 0.00005141% |
| 牛顿法 vs fsolve | 9.24189367e+01 m | 0.00002835% |
| 弦截法 vs fsolve | 7.52048020e+01 m | 0.00002307% |

## 4. 分析与讨论

### 4.1 L1点的物理意义

请分析L1点的物理意义及其在空间任务中的应用价值：
- L1点为什么能保持卫星相对于地球和月球静止？
- 在L1点放置卫星有什么实际应用？

根据牛顿万有引力定律与牛顿第二定律列出的牛顿运动学方程，在该点处万有引力与惯性力相互抵消，在非惯性参考系下呈现受力平衡的状态，卫星能够保持相对静止。这样显示终就能实现地月同步轨道卫星的发射，方便地月之间的信息交流。

### 4.2 数值方法的比较

讨论牛顿法和弦截法在求解此问题时的优缺点：
- 收敛速度比较
- 对初值/初始区间的敏感性
- 计算复杂度和实现难度

牛顿法的收敛速度较快，呈现二阶收敛，而弦截法收敛速度慢，呈现1.618阶的收敛，故而收敛速度上，牛顿法快于弦截法。两者都对初始值的选取较为敏感，牛顿法可能因为导数过小或震荡而发散。弦截法也要确保所选区间内变号，否则也会发散。弦截法只需要计算函数的值即可，适用于导数难以计算的情况，而牛顿法需要显式的导数表达式，但是收敛更快。
### 4.3 思考题

1. 如果将地球质量M增加，L1点的位置将如何变化？请给出物理解释。

会更加靠近月球，地球质量增加，引力场变强，而月球引力场不变，则两个场叠加在一起，越强的引力场会把自己的影响范围越往外扩张。L1点可视作界定地月引力范围的点，地球引力场变强，引力范围就会更大。

2. 除了L1点外，地球-月球系统还有其他拉格朗日点（L2-L5）。这些点的位置如何确定？它们各自有什么特点？

可以通过绘制二维洛希势的图像，寻找曲面上的峰值或盆地，得到所有的5个拉格朗日点。其中L1,L2,L3是不稳定平衡点，与地月共线，L4,L5为稳定平衡点，在地月系统的两侧，分布在洛希势二维曲面的坑里。

## 5. 结论

总结本实验的主要发现和收获，包括对拉格朗日点物理意义的理解以及数值方法在天体力学问题中的应用。

拉格朗日点是研究小行星的轨道运动与迁移的重要物理概念，也是对发射人造卫星技术的实践具有至关重要的作用。在势能平衡点的天体可以在一定的时间内保持相对稳定，从而跟随两题系统在一个稳定的轨道以一个稳定的角速度绕转，可以解释木星的特洛伊带和希腊人带的奇怪现象，也可以为人造地月同步卫星提供理论的指导。

## 核心代码片段

请粘贴您实现的关键函数代码（如L1点位置方程和牛顿法实现），并简要说明代码的核心思路。

def newton_method(f, df, x0, tol=1e-8, max_iter=100):
    """
    使用牛顿法（切线法）求解方程f(x)=0
    参数:
        f (callable): 目标方程，形式为f(x)=0
        df (callable): 目标方程的导数
        x0 (float): 初始猜测值
        tol (float): 收敛容差
        max_iter (int): 最大迭代次数
    """
    x = x0
    iterations = 0
    converged = False
    
    for i in range(max_iter):
        fx = f(x)
        if abs(fx) < tol:
            converged = True
            iterations = i + 1
            break
        
        dfx = df(x)
        if abs(dfx) < 1e-14:  # 避免除以接近零的数
            break
        
        delta = fx / dfx
        x_new = x - delta
        
        # 检查相对变化是否小于容差
        if abs(delta / x) < tol:
            converged = True
            iterations = i + 1
            x = x_new
            break
        
        x = x_new
        iterations = i + 1
    
    return x, iterations, converged


代码说明：
牛顿法求解函数零点：牛顿法计算当前函数值与导数值，若函数值绝对值小于tol，判定收敛，返回结果。若导数值接近于0，终止迭代以免数值不稳定。再更新近似解，若相对变化量小于容差，则收敛。
